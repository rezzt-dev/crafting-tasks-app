<Window x:Class="craftingTask.view.windows.windows_dialogs.task_dialogs.TaskDetailsDialog" 
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:local="clr-namespace:craftingTask.view.windows.windows_dialogs.task_dialogs" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        Title="TaskDetailsDialog" Width="650" Height="830" AllowsTransparency="True" Background="{x:Null}" 
        WindowStartupLocation="CenterScreen" WindowStyle="None" mc:Ignorable="d">
  <Border Background="{StaticResource MainBackground}" CornerRadius="16">
    <Border.Effect>
      <DropShadowEffect BlurRadius="30" Opacity="0.4" ShadowDepth="0" Color="Black"/>
    </Border.Effect>
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="28"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>
      <Grid x:Name="titleBar" Grid.Row="0" Background="Transparent">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="30"/>
          <ColumnDefinition Width="30"/>
        </Grid.ColumnDefinitions>
        <Button x:Name="minimizeButton" Grid.Column="1" Width="12" Height="12" Margin="4,6,6,4" Click="btnMinimizeWindowClick" Style="{StaticResource MinimizeWindowButton}">
          <Viewbox>
            <Path Width="16" Height="14" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M2,7 L14,7" Opacity="0.5" Stroke="Black" StrokeThickness="2"/>
          </Viewbox>
        </Button>
        <Button x:Name="closeButton" Grid.Column="2" Width="12" Height="12" Margin="4,6,6,4" Click="btnCloseWindowClick" Style="{StaticResource CloseWindowButton}">
          <Viewbox>
            <Canvas Width="16" Height="14" Margin="2" Opacity="0.5">
              <Path Data="M2,2 L14,12" Stroke="Black" StrokeThickness="2"/>
              <Path Data="M14,2 L2,12" Stroke="Black" StrokeThickness="2"/>
            </Canvas>
          </Viewbox>
        </Button>
      </Grid>
      <Grid Grid.Row="1" Margin="0,10,0,10">
        <Grid.RowDefinitions>
          <RowDefinition Height="*"/>
          <RowDefinition Height="55"/>
        </Grid.RowDefinitions>
        <ScrollViewer Grid.Row="0" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
          <ScrollViewer.Resources>
            <Style BasedOn="{StaticResource DarkScrollBarStyle}" TargetType="ScrollBar"/>
          </ScrollViewer.Resources>
          <StackPanel Margin="40,10,40,15" HorizontalAlignment="Stretch">
            <Border Margin="0,0,0,20" Padding="30,25" Background="{StaticResource SecondaryBackground}" CornerRadius="14">
              <Border.Effect>
                <DropShadowEffect BlurRadius="10" Opacity="0.3" ShadowDepth="2"/>
              </Border.Effect>
              <StackPanel HorizontalAlignment="Center">
                <Border x:Name="colorIndicator" Width="80" Height="5" Margin="0,0,0,20" HorizontalAlignment="Center" CornerRadius="3"/>
                <TextBlock x:Name="txtTaskTitle" Margin="0,0,0,18" FontSize="26" FontWeight="Bold" Foreground="{StaticResource MainForeground}" TextAlignment="Center" TextWrapping="Wrap"/>
                <Border Padding="16,8" HorizontalAlignment="Center" Background="#15FFFFFF" BorderBrush="#35FFFFFF" BorderThickness="1.5" CornerRadius="10">
                  <StackPanel Orientation="Horizontal">
                    <Ellipse Width="9" Height="9" Margin="0,0,10,0" VerticalAlignment="Center" Fill="#4CAF50"/>
                    <TextBlock x:Name="txtTaskTag" FontSize="12" FontWeight="SemiBold" Foreground="{StaticResource MainForeground}"/>
                  </StackPanel>
                </Border>
              </StackPanel>
            </Border>
            <Border Margin="0,0,0,20" Padding="28,24" Background="{StaticResource SecondaryBackground}" CornerRadius="14">
              <StackPanel>
                <TextBlock Margin="12,5,0,10" FontSize="15" FontWeight="SemiBold" Foreground="#999" Text="Descripción" TextAlignment="Left"/>
                <TextBlock x:Name="txtTaskDescription" FontSize="12" Foreground="{StaticResource MainForeground}" LineHeight="24" TextAlignment="Left" TextWrapping="Wrap"/>
              </StackPanel>
            </Border>
            <Border Margin="0,0,0,20" Padding="28,24" Background="{StaticResource SecondaryBackground}" CornerRadius="14">
              <StackPanel>
                <Grid Margin="0,0,0,15">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>
                  <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                    <TextBlock VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold" Foreground="#999" Text="Checklist"/>
                  </StackPanel>
                  <TextBlock x:Name="txtProgress" Grid.Column="1" VerticalAlignment="Center" FontSize="14" FontWeight="Bold" Foreground="{StaticResource MainForeground}" Text="0/0"/>
                </Grid>
                <Border Height="6" Margin="0,0,0,20" Background="#252525" ClipToBounds="True" CornerRadius="3">
                  <ProgressBar x:Name="progressBar" Height="6" Background="Transparent" BorderThickness="0" Foreground="#4CAF50" Maximum="100" Value="0"/>
                </Border>
                <ItemsControl x:Name="lstSubtasks" Margin="0,0,0,15">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Border Margin="0,0,0,8" Padding="12,10" Background="#1A1A1A" BorderBrush="#2A2A2A" BorderThickness="1" CornerRadius="8">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <CheckBox Margin="0,0,12,0" VerticalAlignment="Center" Checked="Subtask_Checked" IsChecked="{Binding IsCompleted}" Tag="{Binding SubtaskId}" Unchecked="Subtask_Unchecked">
                            <CheckBox.Template>
                              <ControlTemplate TargetType="CheckBox">
                                <Grid Background="Transparent">
                                  <Border x:Name="Box" Width="20" Height="20" Background="Transparent" BorderBrush="#555" BorderThickness="1.5" CornerRadius="6" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <Canvas Width="14" Height="14" HorizontalAlignment="Center" VerticalAlignment="Center">
                                      <Path x:Name="CheckMark" Data="M2,7 L5.5,10.5 L12,3" Stroke="#4CAF50" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" Visibility="Collapsed"/>
                                    </Canvas>
                                  </Border>
                                </Grid>

                                <ControlTemplate.Triggers>
                                  <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="Box" Property="BorderBrush" Value="#4CAF50"/>
                                    <Setter TargetName="Box" Property="Background" Value="#104CAF50"/>
                                  </Trigger>

                                  <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Box" Property="BorderBrush" Value="#888"/>
                                  </Trigger>
                                </ControlTemplate.Triggers>
                              </ControlTemplate>
                            </CheckBox.Template>
                          </CheckBox>
                          <TextBlock x:Name="txtTitle" Grid.Column="1" VerticalAlignment="Center" FontSize="14" Foreground="{StaticResource MainForeground}" Text="{Binding Title}" TextWrapping="Wrap"/>
                          <Button Grid.Column="2" Click="BtnDeleteSubtask_Click" Cursor="Hand" Opacity="0.6" Style="{StaticResource InvisibleButton}" Tag="{Binding SubtaskId}">
                            <Button.Template>
                              <ControlTemplate TargetType="Button">
                                <Border Padding="5" Background="Transparent">
                                  <Path Width="10" Height="10" Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" Fill="#FF6B6B" Stretch="Uniform"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                  <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Opacity" Value="1"/>
                                  </Trigger>
                                </ControlTemplate.Triggers>
                              </ControlTemplate>
                            </Button.Template>
                          </Button>
                        </Grid>
                        <Border.Style>
                          <Style TargetType="Border">
                            <Style.Triggers>
                              <DataTrigger Binding="{Binding IsCompleted}" Value="True">
                                <Setter Property="Opacity" Value="0.6"/>
                              </DataTrigger>
                            </Style.Triggers>
                          </Style>
                        </Border.Style>
                      </Border>
                      <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding IsCompleted}" Value="True">
                          <Setter TargetName="txtTitle" Property="TextDecorations" Value="Strikethrough"/>
                          <Setter TargetName="txtTitle" Property="Foreground" Value="#888"/>
                        </DataTrigger>
                      </DataTemplate.Triggers>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>
                  <TextBox x:Name="txtNewSubtask" Height="40" Padding="12,0" VerticalContentAlignment="Center" Style="{StaticResource SimpleDarkTextBoxStyle}" Tag="Añadir un elemento..."/>
                  <Button Grid.Column="1" Width="80" Height="40" Margin="10,0,0,0" Background="#2A2A2A" BorderBrush="#3A3A3A" Click="BtnAddSubtask_Click" Content="Añadir" Style="{StaticResource FunctionButtonStyle}"/>
                </Grid>
              </StackPanel>
            </Border>
            <Grid Margin="0,0,0,20">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="15"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>
              <Border Grid.Column="0" Margin="0" Padding="10,10" Background="{StaticResource SecondaryBackground}" CornerRadius="14">
                <Grid Margin="12,0" VerticalAlignment="Center">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>
                  <Grid Grid.Row="0" Margin="0,12">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="auto"/>
                      <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                      <RowDefinition Height="*"/>
                      <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Width="35" Height="35" VerticalAlignment="Center" Background="#1E88E5" CornerRadius="25">
                      <Viewbox Width="18" Height="19" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Canvas Width="28" Height="28">
                          <Path Width="28" Height="28" HorizontalAlignment="Center" VerticalAlignment="Top" Data="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z" Fill="{StaticResource SecondaryBackground}" Stretch="Fill"/>
                        </Canvas>
                      </Viewbox>
                    </Border>
                    <TextBlock Grid.Row="0" Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold" Foreground="#999" Text="Fecha de Creación"/>
                    <TextBlock x:Name="txtCreationDate" Grid.Row="1" Grid.Column="1" Margin="12,0,0,0" HorizontalAlignment="Left" FontSize="12" FontWeight="Bold" Foreground="{StaticResource MainForeground}" TextAlignment="Center"/>
                  </Grid>
                </Grid>
              </Border>
              <Border Grid.Column="2" Margin="0" Padding="10,10" Background="{StaticResource SecondaryBackground}" CornerRadius="14">
                <Grid Margin="12,0" VerticalAlignment="Center">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                  </Grid.RowDefinitions>
                  <Grid Grid.Row="0" Margin="0,12">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto"/>
                      <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                      <RowDefinition Height="*"/>
                      <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Width="35" Height="35" VerticalAlignment="Center" Background="#F44336" CornerRadius="25">
                      <Viewbox Width="20" Height="21" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Canvas Width="28" Height="28">
                          <Path Width="28" Height="28" Data="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z" Fill="{StaticResource SecondaryBackground}" Stretch="Fill"/>
                        </Canvas>
                      </Viewbox>
                    </Border>
                    <TextBlock Grid.Row="0" Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold" Foreground="#999" Text="Fecha Límite"/>
                    <TextBlock x:Name="txtEndDate" Grid.Row="1" Grid.Column="1" Margin="12,0,0,0" HorizontalAlignment="Left" FontSize="12" FontWeight="Bold" Foreground="{StaticResource MainForeground}" TextAlignment="Center"/>
                  </Grid>
                </Grid>
              </Border>
            </Grid>
            <Border Margin="0" Padding="10,10" Background="{StaticResource SecondaryBackground}" CornerRadius="14">
              <Grid>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Margin="0,12" HorizontalAlignment="Center">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                  </Grid.RowDefinitions>
                  <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Width="35" Height="35" VerticalAlignment="Center" Background="#FF9800" CornerRadius="30">
                    <Viewbox Width="20" Height="20" HorizontalAlignment="Center" VerticalAlignment="Center">
                      <Canvas Width="35" Height="35">
                        <Path Width="35" Height="35" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2Z" Fill="{StaticResource SecondaryBackground}" Stretch="Uniform"/>
                      </Canvas>
                    </Viewbox>
                  </Border>
                  <TextBlock Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold" Foreground="#999" Text="Prioridad"/>
                  <TextBlock x:Name="txtPriority" Grid.Row="1" Grid.Column="1" Margin="12,0,0,0" HorizontalAlignment="Left" FontSize="12" FontWeight="Bold" Foreground="{StaticResource MainForeground}" TextAlignment="Center"/>
                </Grid>
              </Grid>
            </Border>
          </StackPanel>
        </ScrollViewer>
        <Grid Grid.Row="1" Margin="70,10,70,0">
          <Button x:Name="btnClose" Height="40" Padding="0,6" VerticalAlignment="Center" Click="btnClose_Click" Content="Cerrar" Style="{StaticResource FunctionButtonStyle}"/>
        </Grid>
      </Grid>
    </Grid>
  </Border>
</Window>
